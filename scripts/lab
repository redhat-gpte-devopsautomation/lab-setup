#/usr/bin/bash


MAIN_PLAYBOOK=/srv/lab-setup/main.yml
DEPLOY_ERROR_MSG="\e[31;1m Environment is not available, Choose \e[5m multitier, tower, molecule, nodes, haproxy, tower_patch, gitlab \e[0m \n"
DESTROY_ERROR_MSG="\e[31;1m Environment is not available, Choose \e[5m multitier, tower, molecule, nodes \e[0m\n"

# CAlls
# deploy,destroy

if [ "${1}" == "deploy" ];then
	case ${2} in
		molecule) 
			ansible-playbook ${MAIN_PLAYBOOK} -e env_type=${2} 
			;;
		tower)
			ansible-playbook ${MAIN_PLAYBOOK} -e env_type=${2}
			;;
	 	multitier)
			ansible-playbook ${MAIN_PLAYBOOK} -e env_type=${2} 
			;;
	 	nodes)
			ansible-playbook ${MAIN_PLAYBOOK} -e env_type=${2} 
			;;
	 	haproxy)
			ansible-playbook /srv/lab-setup/haproxy.yml -e env_type=pod -e pod_type=gitlab
			;;
		tower_patch) 
			ansible-playbook /srv/lab-setup/tower-patch.yml
			;;
		gitlab)
			ansible-playbook /srv/lab-setup/pod-main.yml -e env_type=pod -e pod_type=gitlab
			;;
			
		*)
			echo -e "${DEPLOY_ERROR_MSG}"
		 ;;
	esac

	elif [ "${1}" == "destroy" ]; then
	case ${2} in
		molecule) 
			ansible-playbook ${MAIN_PLAYBOOK} -e env_type=${2} -e env_destroy=true 
			;;
		tower)
			ansible-playbook ${MAIN_PLAYBOOK} -e env_type=${2} -e env_destroy=true
			;;
	 	multitier)
			ansible-playbook ${MAIN_PLAYBOOK} -e env_type=${2} -e env_destroy=true
			;;
	 	nodes)
			ansible-playbook ${MAIN_PLAYBOOK} -e env_type=${2} -e env_destroy=true
			;;
		*)
			echo -e "${DESTROY_ERROR_MSG}"
		 ;;
	esac

	else
		echo "Wrong option, Use deploy or destroy"
fi
