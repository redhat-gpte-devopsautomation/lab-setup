#/usr/bin/bash


MAIN_PLAYBOOK=/srv/lab-setup/main.yml
DEPLOY_ERROR_MSG="Environment is not available, Choose multitier, tower, molecule, haproxy, tower_patch, gitlab"
DESTROY_ERROR_MSG="Environment is not available, Choose multitier, tower, molecule"

# CAlls
# deploy,destroy

if [ "${1}" == "deploy" ];then
	case ${2} in
		molecule) 
			ansible-playbook ${MAIN_PLAYBOOK} -e env_type=${2} 
			;;
		tower)
			ansible-playbook ${MAIN_PLAYBOOK} -e env_type=${2}
			;;
	 	multitier)
			ansible-playbook ${MAIN_PLAYBOOK} -e env_type=${2} 
			;;
	 	haproxy)
			ansible-playbook /srv/lab-setup/haproxy.yml -e env_type=pod -e pod_type=gitlab
			;;
		tower_patch) 
			ansible-playbook /srv/lab-setup/tower-patch.yml
			;;
		haproxy)
			ansible-playbook /srv/lab-setup/pod-main.yml -e env_type=pod -e pod_type=gitlab
			;;
			
		*)
			echo "${DEPLOY_ERROR_MSG}"
		 ;;
	esac

	elif [ "${1}" == "destroy" ]; then
	case ${2} in
		molecule) 
			ansible-playbook ${MAIN_PLAYBOOK} -e env_type=${2} -e env_destroy=true 
			;;
		tower)
			ansible-playbook ${MAIN_PLAYBOOK} -e env_type=${2} -e env_destroy=true
			;;
	 	multitier)
			ansible-playbook ${MAIN_PLAYBOOK} -e env_type=${2} -e env_destroy=true
			;;
		*)
			echo "${DESTROY_ERROR_MSG}"
		 ;;
	esac

	else
		echo "Wrong option, Use deploy or destroy"
fi
